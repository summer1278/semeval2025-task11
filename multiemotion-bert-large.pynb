{"cells":[{"cell_type":"code","execution_count":31,"metadata":{"executionInfo":{"elapsed":3827,"status":"ok","timestamp":1734398684123,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"x8Xyd78FSBFs"},"outputs":[],"source":["!pip install -q transformers datasets"]},{"cell_type":"code","execution_count":32,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1263,"status":"ok","timestamp":1734398685383,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"hayXl0EKSILi","outputId":"32e6d434-30b9-4018-c2fd-ab92f52afdba"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":33,"metadata":{"id":"NY4umX7ark9A","executionInfo":{"status":"ok","timestamp":1734398685383,"user_tz":0,"elapsed":8,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"}}},"outputs":[],"source":["import pandas as pd\n","train_df = pd.read_csv(\"/content/drive/MyDrive/data/semeval2025-11/train/track_a/eng.csv\")"]},{"cell_type":"code","execution_count":34,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1734398685384,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"1EYvGgHcSTh8","outputId":"0a21682c-adf7-43ee-b81e-9b44ffc24f74"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                        id                                               text  \\\n","0  eng_train_track_a_00001                                But not very happy.   \n","1  eng_train_track_a_00002  Well she's not gon na last the whole song like...   \n","2  eng_train_track_a_00003  She sat at her Papa's recliner sofa only to mo...   \n","3  eng_train_track_a_00004                    Yes, the Oklahoma city bombing.   \n","4  eng_train_track_a_00005                       They were dancing to Bolero.   \n","\n","   Anger  Fear  Joy  Sadness  Surprise  \n","0      0     0    1        1         0  \n","1      0     0    1        0         0  \n","2      0     0    0        0         0  \n","3      1     1    0        1         1  \n","4      0     0    1        0         0  "],"text/html":["\n","  <div id=\"df-ecd04d7b-3ceb-4ae9-b201-7d3a216b38e0\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>text</th>\n","      <th>Anger</th>\n","      <th>Fear</th>\n","      <th>Joy</th>\n","      <th>Sadness</th>\n","      <th>Surprise</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>eng_train_track_a_00001</td>\n","      <td>But not very happy.</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>eng_train_track_a_00002</td>\n","      <td>Well she's not gon na last the whole song like...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>eng_train_track_a_00003</td>\n","      <td>She sat at her Papa's recliner sofa only to mo...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>eng_train_track_a_00004</td>\n","      <td>Yes, the Oklahoma city bombing.</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>eng_train_track_a_00005</td>\n","      <td>They were dancing to Bolero.</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ecd04d7b-3ceb-4ae9-b201-7d3a216b38e0')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-ecd04d7b-3ceb-4ae9-b201-7d3a216b38e0 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-ecd04d7b-3ceb-4ae9-b201-7d3a216b38e0');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-8d7436a1-d753-436b-8cde-38be267ea850\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-8d7436a1-d753-436b-8cde-38be267ea850')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-8d7436a1-d753-436b-8cde-38be267ea850 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"train_df","summary":"{\n  \"name\": \"train_df\",\n  \"rows\": 2768,\n  \"fields\": [\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 2768,\n        \"samples\": [\n          \"eng_train_track_a_01379\",\n          \"eng_train_track_a_00840\",\n          \"eng_train_track_a_02165\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 2764,\n        \"samples\": [\n          \"Then I got to a parking lot and got a funny idea in my head to toss it at a car.\",\n          \"Not a great first impression, but we brush it off.\",\n          \"\\\"Jeff what is that?\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Anger\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          1,\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Fear\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          1,\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Joy\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          0,\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Sadness\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          0,\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Surprise\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          1,\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":34}],"source":["train_df.head()"]},{"cell_type":"code","execution_count":35,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1734398685384,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"vdOfFwcVSb55","outputId":"6b5f32b0-d275-4fc3-9239-90bbcd2c66fd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['Anger', 'Fear', 'Joy', 'Sadness', 'Surprise']"]},"metadata":{},"execution_count":35}],"source":["labels = [label for label in train_df.keys() if label not in ['id', 'text']]\n","id2label = {idx:label for idx, label in enumerate(labels)}\n","label2id = {label:idx for idx, label in enumerate(labels)}\n","labels"]},{"cell_type":"code","execution_count":36,"metadata":{"executionInfo":{"elapsed":479,"status":"ok","timestamp":1734398685856,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"gm1BY5NzSfDW"},"outputs":[],"source":["from transformers import AutoTokenizer\n","import numpy as np\n","\n","tokenizer = AutoTokenizer.from_pretrained(\"bert-large-uncased\")\n","\n","def preprocess_data(examples):\n","  # take a batch of texts\n","  text = examples[\"text\"]\n","  # encode them\n","  encoding = tokenizer(text, padding=\"max_length\", truncation=True, max_length=512)\n","  # add labels\n","  labels_batch = {k: examples[k] for k in examples.keys() if k in labels}\n","  # create numpy array of shape (batch_size, num_labels)\n","  labels_matrix = np.zeros((len(text), len(labels)))\n","  # fill numpy array\n","  for idx, label in enumerate(labels):\n","    labels_matrix[:, idx] = labels_batch[label]\n","\n","  encoding[\"labels\"] = labels_matrix.tolist()\n","\n","  return encoding"]},{"cell_type":"code","execution_count":37,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":293,"status":"ok","timestamp":1734398685857,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"xyiG6fcOShFB","outputId":"a978c309-6bc1-4423-b129-adb6e5408e89"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['id', 'text', 'Anger', 'Fear', 'Joy', 'Sadness', 'Surprise'],\n","        num_rows: 1937\n","    })\n","    test: Dataset({\n","        features: ['id', 'text', 'Anger', 'Fear', 'Joy', 'Sadness', 'Surprise'],\n","        num_rows: 831\n","    })\n","})"]},"metadata":{},"execution_count":37}],"source":["import datasets\n","dataset = datasets.Dataset.from_pandas(train_df)\n","dataset=dataset.train_test_split(test_size=0.3)\n","dataset"]},{"cell_type":"code","execution_count":38,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["b4356740413c4faca45995bdb7a53f59","14a48e5ff03d48fc8d9a00b8c3808924","ebe1711e1f3f49d1a449594c9ee2b01f","256cff3eb33a436487ba8ea86738ca93","4bbf99b17dfe449ca6d0696192cceae9","4cc9204478c54dae92a04b7593ed2b9d","e5dac1d6a66b4b2cb18b66b55282c343","57d7c6d198e343748a2807f20b1cebc9","a4682f4d757a4e19b54961ce15ffb467","bc2257bc542c448ba970716e6cfc7605","ebc6c870aa8a481e888afa6d0f099883","08f92a0e52e74f9eaefc3798a8457116","4a415f69ca0142f4a44f9766e296a39d","64c21371f9bb4596b81890aa3031e011","687573313a18479794a55dd044ac41a7","72e8cd668faa4c77b5b5985b3f7afae6","ea83fd2710c144f1be74aad27a384050","fb7bb774a0e64d33a9faccb9c87fd9c1","9dba016fdd1941b1add390de08144cd3","ff2331386230449fbf0b4dc95d743e63","a22fa8b612ac40a0bebbe0312a9c42bb","5ec77e576807475c8cdacecae57ab1fb"]},"executionInfo":{"elapsed":2527,"status":"ok","timestamp":1734398688380,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"ArooKilfwdsh","outputId":"c1bc0c32-7260-4ebb-9a7d-d7d0ee96863f"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/1937 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b4356740413c4faca45995bdb7a53f59"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/831 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"08f92a0e52e74f9eaefc3798a8457116"}},"metadata":{}}],"source":["encoded_dataset = dataset.map(preprocess_data, batched=True, remove_columns=dataset['train'].column_names)"]},{"cell_type":"code","execution_count":39,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1734398688380,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"qf4AD058Sme8","outputId":"6615c544-8755-489a-cbef-496feb34682d"},"outputs":[{"output_type":"stream","name":"stdout","text":["dict_keys(['input_ids', 'token_type_ids', 'attention_mask', 'labels'])\n"]}],"source":["example = encoded_dataset['train'][0]\n","print(example.keys())"]},{"cell_type":"code","execution_count":40,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":157},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1734398688380,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"Pl-yI2VrSpEO","outputId":"43ddceed-1bfe-45d4-bf66-4b888ec9b585"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'[CLS] watching her leave with dudes drove me crazy. [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":40}],"source":["tokenizer.decode(example['input_ids'])"]},{"cell_type":"code","execution_count":41,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1734398688607,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"Aj45H0kDSsnV","outputId":"becb6493-af66-4e64-f8ec-2fc3f75f2a3b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["[1.0, 1.0, 0.0, 1.0, 0.0]"]},"metadata":{},"execution_count":41}],"source":["example['labels']"]},{"cell_type":"code","execution_count":42,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1734398688607,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"RDjob6YCSunb","outputId":"b39f7660-49f6-4167-9f16-37690b461050"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['Anger', 'Fear', 'Sadness']"]},"metadata":{},"execution_count":42}],"source":["[id2label[idx] for idx, label in enumerate(example['labels']) if label == 1.0]"]},{"cell_type":"code","execution_count":43,"metadata":{"id":"x2gi-kGzSwWl","executionInfo":{"status":"ok","timestamp":1734398688608,"user_tz":0,"elapsed":7,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"}}},"outputs":[],"source":["encoded_dataset.set_format(\"torch\")"]},{"cell_type":"code","execution_count":44,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1338,"status":"ok","timestamp":1734398689940,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"L3_C48bVSzTK","outputId":"16ff0dc9-5f23-4bb5-dc50-73f1887949d7"},"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-large-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}],"source":["from transformers import AutoModelForSequenceClassification\n","\n","model = AutoModelForSequenceClassification.from_pretrained(\"bert-large-uncased\",\n","                                                           problem_type=\"multi_label_classification\",\n","                                                           num_labels=len(labels),\n","                                                           id2label=id2label,\n","                                                           label2id=label2id)"]},{"cell_type":"code","execution_count":45,"metadata":{"id":"Q_TZGj6LS2PO","executionInfo":{"status":"ok","timestamp":1734398689940,"user_tz":0,"elapsed":3,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"}}},"outputs":[],"source":["batch_size = 8\n","metric_name = \"f1_micro\""]},{"cell_type":"code","execution_count":46,"metadata":{"id":"KUcL1EexS5ZB","executionInfo":{"status":"ok","timestamp":1734398689940,"user_tz":0,"elapsed":3,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"}}},"outputs":[],"source":["from transformers import TrainingArguments, Trainer\n","\n","args = TrainingArguments(\n","    f\"bert-large-finetuned-sem_eval-english\",\n","    eval_strategy = \"epoch\",\n","    save_strategy = \"epoch\",\n","    learning_rate=2e-5,\n","    per_device_train_batch_size=batch_size,\n","    per_device_eval_batch_size=batch_size,\n","    num_train_epochs=8,\n","    weight_decay=0.01,\n","    load_best_model_at_end=True,\n","    metric_for_best_model=metric_name,\n","    report_to=\"none\"\n",")"]},{"cell_type":"code","execution_count":47,"metadata":{"id":"lSmY7-3uTCTM","executionInfo":{"status":"ok","timestamp":1734398689940,"user_tz":0,"elapsed":3,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"}}},"outputs":[],"source":["from sklearn.metrics import f1_score, roc_auc_score, accuracy_score\n","from sklearn.metrics import jaccard_score\n","from transformers import EvalPrediction\n","import torch\n","\n","def multi_label_metrics(predictions, labels, threshold=0.5):\n","    # first, apply sigmoid on predictions which are of shape (batch_size, num_labels)\n","    sigmoid = torch.nn.Sigmoid()\n","    probs = sigmoid(torch.Tensor(predictions))\n","    # next, use threshold to turn them into integer predictions\n","    y_pred = np.zeros(probs.shape)\n","    y_pred[np.where(probs >= threshold)] = 1\n","    # finally, compute metrics\n","    y_true = labels\n","    f1_micro_average = f1_score(y_true=y_true, y_pred=y_pred, average='micro')\n","    f1_macro_average = f1_score(y_true=y_true, y_pred=y_pred, average='macro')\n","    roc_auc = roc_auc_score(y_true, y_pred, average = 'micro')\n","    accuracy = accuracy_score(y_true, y_pred)\n","    jaccard = jaccard_score(y_true, y_pred, average = 'samples')\n","    # return as dictionary\n","    metrics = {'f1_micro': f1_micro_average,\n","               'f1_macro': f1_macro_average,\n","               'roc_auc': roc_auc,\n","               'accuracy': accuracy,\n","               'jaccard': jaccard}\n","    return metrics\n","\n","def compute_metrics(p: EvalPrediction):\n","    preds = p.predictions[0] if isinstance(p.predictions,\n","            tuple) else p.predictions\n","    result = multi_label_metrics(\n","        predictions=preds,\n","        labels=p.label_ids)\n","    return result"]},{"cell_type":"code","execution_count":48,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"executionInfo":{"elapsed":193,"status":"ok","timestamp":1734398690131,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"tHBUBicsTGRf","outputId":"2515001c-ce17-48f1-e089-65dbc3841967"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'torch.FloatTensor'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":48}],"source":["encoded_dataset['train'][0]['labels'].type()"]},{"cell_type":"code","execution_count":49,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1734398690131,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"UB3jjau_TJcT","outputId":"060e4915-9933-4a60-a627-cc9bb88c397b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([  101,  3666,  2014,  2681,  2007, 12043,  2015,  5225,  2033,  4689,\n","         1012,   102,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0])"]},"metadata":{},"execution_count":49}],"source":["encoded_dataset['train']['input_ids'][0]"]},{"cell_type":"code","execution_count":50,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21765,"status":"ok","timestamp":1734398711893,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"},"user_tz":0},"id":"65-18NRyTLaf","outputId":"3d559fea-37a8-423e-a31d-2b463b90ef07"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["SequenceClassifierOutput(loss=tensor(0.6108, grad_fn=<BinaryCrossEntropyWithLogitsBackward0>), logits=tensor([[ 0.2803,  0.3976, -0.2408,  0.0683,  0.0875]],\n","       grad_fn=<AddmmBackward0>), hidden_states=None, attentions=None)"]},"metadata":{},"execution_count":50}],"source":["#forward pass\n","outputs = model(input_ids=encoded_dataset['train']['input_ids'][0].unsqueeze(0), labels=encoded_dataset['train'][0]['labels'].unsqueeze(0))\n","outputs"]},{"cell_type":"code","execution_count":51,"metadata":{"id":"HlL-spRvTNq4","executionInfo":{"status":"ok","timestamp":1734398713107,"user_tz":0,"elapsed":1217,"user":{"displayName":"Xia Cui","userId":"12445232206577617367"}}},"outputs":[],"source":["trainer = Trainer(\n","    model,\n","    args,\n","    train_dataset=encoded_dataset[\"train\"],\n","    eval_dataset=encoded_dataset[\"test\"],\n","    processing_class=tokenizer,\n","    compute_metrics=compute_metrics,\n","    # report_to=\"none\"\n",")\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":75},"id":"44eULT36TPuU","outputId":"e068230e-10ee-44a2-919d-72ab43d0b4b2"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='77' max='1944' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [  77/1944 02:53 < 1:11:46, 0.43 it/s, Epoch 0.31/8]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table><p>"]},"metadata":{}}],"source":["trainer.train()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pC0KtDZNUHZt"},"outputs":[],"source":["trainer.evaluate()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uk70hJQp3iYU"},"outputs":[],"source":["# save model\n","trainer.save_model(\"/content/drive/MyDrive/data/semeval2025-11/bert-large/\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"66og_lvt0X1X"},"outputs":[],"source":["dev_df = pd.read_csv(\"/content/drive/MyDrive/data/semeval2025-11/dev/track_a/eng_a.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kqa8IZgB5MPP"},"outputs":[],"source":["def predict_labels(text):\n","  encoding = tokenizer(text, return_tensors=\"pt\")\n","  encoding = {k: v.to(trainer.model.device) for k,v in encoding.items()}\n","\n","  outputs = trainer.model(**encoding)\n","  logits = outputs.logits\n","  # apply sigmoid + threshold\n","  sigmoid = torch.nn.Sigmoid()\n","  probs = sigmoid(logits.squeeze().cpu())\n","  predictions = np.zeros(probs.shape)\n","  predictions[np.where(probs >=0.5)] = 1\n","  if sum(predictions)==0:\n","    predictions[probs.tolist().index(max(probs.tolist()))]=1\n","  predictions = [int(item) for item in predictions]\n","  # turn predicted id's into actual label names\n","  predicted_labels = [id2label[idx] for idx, label in enumerate(predictions) if label == 1]\n","  print(predicted_labels, predictions)\n","  return predicted_labels, predictions"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_eQKv4xmWl48"},"outputs":[],"source":["results = []\n","texts = dev_df['text'].tolist()\n","ids = dev_df['id'].tolist()\n","for text,id in zip(texts,ids):\n","  _,predictions = predict_labels(text)\n","  result = dict(zip(labels, predictions))\n","  result['id'] = id\n","  results.append(result)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5My3Nz-PWmUC"},"outputs":[],"source":["result_df = pd.DataFrame(results)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"h4TEdC0g09qM"},"outputs":[],"source":["#reconstruct to id,Joy,Anger,Sadness,Surprise,Fear\n","result_df = result_df[['id','Anger', 'Fear', 'Joy', 'Sadness', 'Surprise']]\n","result_df.to_csv('/content/drive/MyDrive/data/semeval2025-11/pred_eng_a.csv',index=False)"]}],"metadata":{"colab":{"provenance":[{"file_id":"1nAfDMz-Zux4OhCmsCjcioRkxKMmIvJJQ","timestamp":1734396327845}],"gpuType":"T4","authorship_tag":"ABX9TyMJnu5g94N7JGH3Dn7W4Ujw"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"b4356740413c4faca45995bdb7a53f59":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_14a48e5ff03d48fc8d9a00b8c3808924","IPY_MODEL_ebe1711e1f3f49d1a449594c9ee2b01f","IPY_MODEL_256cff3eb33a436487ba8ea86738ca93"],"layout":"IPY_MODEL_4bbf99b17dfe449ca6d0696192cceae9"}},"14a48e5ff03d48fc8d9a00b8c3808924":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4cc9204478c54dae92a04b7593ed2b9d","placeholder":"​","style":"IPY_MODEL_e5dac1d6a66b4b2cb18b66b55282c343","value":"Map: 100%"}},"ebe1711e1f3f49d1a449594c9ee2b01f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_57d7c6d198e343748a2807f20b1cebc9","max":1937,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a4682f4d757a4e19b54961ce15ffb467","value":1937}},"256cff3eb33a436487ba8ea86738ca93":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bc2257bc542c448ba970716e6cfc7605","placeholder":"​","style":"IPY_MODEL_ebc6c870aa8a481e888afa6d0f099883","value":" 1937/1937 [00:01&lt;00:00, 1251.86 examples/s]"}},"4bbf99b17dfe449ca6d0696192cceae9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4cc9204478c54dae92a04b7593ed2b9d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e5dac1d6a66b4b2cb18b66b55282c343":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"57d7c6d198e343748a2807f20b1cebc9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a4682f4d757a4e19b54961ce15ffb467":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bc2257bc542c448ba970716e6cfc7605":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ebc6c870aa8a481e888afa6d0f099883":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"08f92a0e52e74f9eaefc3798a8457116":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4a415f69ca0142f4a44f9766e296a39d","IPY_MODEL_64c21371f9bb4596b81890aa3031e011","IPY_MODEL_687573313a18479794a55dd044ac41a7"],"layout":"IPY_MODEL_72e8cd668faa4c77b5b5985b3f7afae6"}},"4a415f69ca0142f4a44f9766e296a39d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ea83fd2710c144f1be74aad27a384050","placeholder":"​","style":"IPY_MODEL_fb7bb774a0e64d33a9faccb9c87fd9c1","value":"Map: 100%"}},"64c21371f9bb4596b81890aa3031e011":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9dba016fdd1941b1add390de08144cd3","max":831,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ff2331386230449fbf0b4dc95d743e63","value":831}},"687573313a18479794a55dd044ac41a7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a22fa8b612ac40a0bebbe0312a9c42bb","placeholder":"​","style":"IPY_MODEL_5ec77e576807475c8cdacecae57ab1fb","value":" 831/831 [00:01&lt;00:00, 878.86 examples/s]"}},"72e8cd668faa4c77b5b5985b3f7afae6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ea83fd2710c144f1be74aad27a384050":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fb7bb774a0e64d33a9faccb9c87fd9c1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9dba016fdd1941b1add390de08144cd3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ff2331386230449fbf0b4dc95d743e63":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a22fa8b612ac40a0bebbe0312a9c42bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5ec77e576807475c8cdacecae57ab1fb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}